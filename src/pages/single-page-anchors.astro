---
import Layout from "../layouts/Layout.astro";
import GraphicSpecies from "../components/GraphicSpecies.astro";

const { species } = Astro.params;
const validSpecies = ['Adelie', 'Gentoo', 'Chinstrap'];
const currentSpecies = validSpecies.includes(species) ? species : 'Adelie';
---

<Layout>
  <nav class="bg-blue-600 text-white p-4 mb-6">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-xl font-bold">Penguins Data Visualization</h1>
      <div class="flex items-center space-x-4">
        <a href="/" class="hover:underline">Accueil</a>
        
        <!-- Select pour la navigation entre espèces -->
        
        
        <a href="/test-inframe/" class="hover:underline">Test Iframe</a>
        <a href="/single-page-anchors/" class="hover:underline">Page avec ancres</a>
        <a href="/single-page-tabs/" class="hover:underline">Page avec onglets</a>
      </div>
    </div>
  </nav>

  <div class="flex items-center space-x-2">
          <label for="species-select" class="text-sm">Espèce:</label>
          <select 
            id="species-select" 
            class="bg-white text-black px-3 py-1 rounded border"
          >
            <option value="Adelie" selected={currentSpecies === 'Adelie'}>Adelie</option>
            <option value="Gentoo" selected={currentSpecies === 'Gentoo'}>Gentoo</option>
            <option value="Chinstrap" selected={currentSpecies === 'Chinstrap'}>Chinstrap</option>
          </select>
        </div>

  <main class="container mx-auto px-4">
    <GraphicSpecies species={currentSpecies} />

    <div class="mt-8 text-center">
      {currentSpecies === 'Adelie' && (
        <p class="text-gray-600">
          Les penguins Adelie sont les plus petits des trois espèces étudiées. Ils
          se trouvent sur les trois îles : Torgersen, Biscoe et Dream.
        </p>
      )}
      {currentSpecies === 'Gentoo' && (
        <p class="text-gray-600">
          Les penguins Gentoo sont les plus grands des trois espèces étudiées. Ils
          se trouvent uniquement sur l'île de Biscoe et sont reconnaissables à 
          leur bec orange.
        </p>
      )}
      {currentSpecies === 'Chinstrap' && (
        <p class="text-gray-600">
          Les penguins Chinstrap sont reconnaissables à la ligne noire qui passe
          sous leur menton, d'où leur nom. Ils se trouvent uniquement sur l'île de
          Dream.
        </p>
      )}
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const speciesSelect = document.querySelector("#species-select");
      
      speciesSelect?.addEventListener("change", (evt) => {
        const value = (evt.target as HTMLSelectElement).value;
        const segments = location.pathname.split("/");
        
        // Assurer que l'URL se termine par /
        const newPath = `/species/${value}/`;
        window.location.href = newPath;
      });
    });
  </script>
</Layout>